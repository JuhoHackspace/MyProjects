
title Sekvenssikaavio

participant Käyttötapaus
participant User
participant Frontend
participant Backend
participant Database
participant Finnkino
participant IMDB

loop #green jee joo jaa
note over Käyttötapaus:Search events
User->Frontend:/search
Frontend->Backend:get areas
Backend->Finnkino:(/xml/TheatreAreas/) get Area ID's
Finnkino->Backend:Api response XML(areas)
Backend->Frontend:Area ID's for search filtering JSON
Frontend->User:List of areas\nto a dropdown for user to choose from
User->Frontend:/search Select parameters(timeframe, theathre)
Frontend->Backend: get events with params(timeframe, area)
Backend->Finnkino: /xml/Schedule/ + params
Finnkino->Backend:Api response XML(events)
Backend->Frontend: Events list JSON
Frontend->User: Show events
end

note over Käyttötapaus: Post event to group
User->Frontend:/search (Authenticated user) Post event to selected group
Frontend->Backend: post event with params(group id, event id)
Backend->Database: insert into events_
Database->Backend: affected rows(1 == ok)
Backend->Frontend: Post event status(ok, fail)
Frontend->User: Inform user

loop #gray
note over Käyttötapaus: Search movies
User->Frontend: /search
note right of Frontend: Mahdolliset parametrit:\n- query string\n- include adult boolean\n- language string
Frontend->Backend: /imdb-proxy/3/search/movie
Backend->IMDB: https://api.themoviedb.org/3/search/movie
IMDB->Backend: List of movies
Backend->Frontend:List of movies
Frontend->User: Found movies
end

note over Käyttötapaus: Create account
User->Frontend: /login/register

note over Käyttötapaus: Delete account
User->Frontend: /profile/delete

loop #gray
note over Käyttötapaus:Login
User->Frontend: /login
Frontend->User: render loginpage
User->Frontend: credentials
Frontend->Backend: login as X
Backend->Database: get userdata
Database->Backend: user or not found
Backend->Frontend: session id/authentication response
Frontend->User: success or failure
end

note over Käyttötapaus: Logout
User->Frontend: /logout

loop #gray
note over Käyttötapaus: Edit profile
User->Frontend: /profile/edit
Frontend->Backend: Edit Profile Params:\n(userId, userName, password_hash)
Backend ->Database:UPDATE userName, password_hash
Database ->Backend: Response status
Backend ->Frontend: Response status
Frontend->User: Show information: Success/failure
end
note over Käyttötapaus: Add to favourites (movie)
User->Frontend: /profile/favourites

note over Käyttötapaus: Share favouritelist

note over Käyttötapaus: Create group
User->Frontend: /profile/groups/creategroup
User->Frontend: /community/groups/creategroup

note over Käyttötapaus: See groups as list
User->Frontend: /community/groups

loop #gray
note over Käyttötapaus: Join group
User->Frontend: /community/groups
note right of Frontend:groupAdmin approve or reject
Frontend --#red:4>User: Show information: reject
Frontend->Backend: /joingroup/groupId
Backend->Database:POST groupId, userId
Database->Backend:Response status
Backend->Frontend:Response status
Frontend->User: Show information: success
end

note over Käyttötapaus: Leave Group
User->Frontend: /profile/groups/groupX

loop #gray
note over Käyttötapaus: Delete group
User->Frontend: /profile/groups/groupX
Frontend--#red:4>User:Are you sure?
User--#green:4>Frontend: Yes, delete

Frontend->Backend:DELETE groupId
Backend->Database:DELETE groupId
Database->Backend:Response status
Backend->Frontend:Response status
Frontend->User:Response status

end
note over Käyttötapaus: Delete user from group

note over Käyttötapaus: Handle group join requests
User->Frontend: /profile/groups/groupX

note over Käyttötapaus: Post reviews
User->Frontend: /community/reviews/newreview

note over Käyttötapaus: Read reviews
User->Frontend: /community/reviews

note over Käyttötapaus: Edit review
User->Frontend: /profile/reviews/reviewX

note over Käyttötapaus: Delete reviews
User->Frontend: /profile/reviews/reviewX

note over Käyttötapaus: Ban or unban user

